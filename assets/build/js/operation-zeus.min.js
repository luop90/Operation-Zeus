/*! operation-zeus 2016-08-02 */
function PodcastPanelDirective(){return{restrict:"E",templateUrl:"partials/podcast-panel.html"}}function PreloaderDirective(){return{restrict:"E",templateUrl:"partials/preloader.html"}}function PreloaderSmallDirective(){return{restrict:"E",templateUrl:"partials/preloader-small.html"}}function PreloaderSmallBlueDirective(){return{restrict:"E",templateUrl:"partials/preloader-small-blue.html"}}function PodcastEpisodeDirective(){return{restrict:"E",templateUrl:"partials/podcast-episode.html"}}function runBlock($window,$rootScope,$location){$rootScope.darkTheme=!0,$rootScope.podcasts=[],Zeus.loadSettings(function(data){$rootScope.settings=data,Zeus.loadSavedPodcasts(function(data){console.log(data),$rootScope.podcasts=data,$rootScope.fullyLoaded=!0})})}var zeus=angular.module("zeus",["ngRoute"]).config(["$routeProvider","$locationProvider",function($routeProvider,$locationProvider){$routeProvider.when("/",{templateUrl:"partials/home.html"}).when("/podcast/:id",{templateUrl:"partials/podcast.html"}).when("/settings",{templateUrl:"partials/settings.html"}).when("/about",{templateUrl:"partials/about.html"}).when("/podcast/:id",{templateUrl:"partials/podcast.html"}).when("/play/:podcast/:episode",{templateUrl:"partials/player.html"}),$locationProvider.html5Mode(!1)}]);angular.module("zeus").directive("podcastPanel",PodcastPanelDirective).directive("preloader",PreloaderDirective).directive("preloaderSmall",PreloaderSmallDirective).directive("preloaderSmallBlue",PreloaderSmallBlueDirective).directive("podcastEpisode",PodcastEpisodeDirective),angular.module("zeus").run(runBlock),zeus.controller("HomePageCtrl",["$scope","$rootScope","$timeout",function($scope,$rootScope,$timeout){$scope.podcasts=$rootScope.podcasts,$("button.modal-trigger").leanModal(),$(".tooltipped").tooltip({delay:50}),$scope.openPodcastModal=function(){Materialize.updateTextFields(),$(".modal#addPodcastModal").openModal()},$scope.addNewPodcast=function(podcastInfo){return $scope.podcastInfo.hasError=!1,$scope.loadingRSSFeed=!0,podcastInfo.url.match(/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)/)?void Zeus.addPodcast(podcastInfo.url,function(err,podcast){return err||!podcast?($scope.podcastInfo.errorMessage="Error: "+String(err),$scope.podcastInfo.hasError=!0,void($scope.loadingRSSFeed=!1)):($(".modal#addPodcastModal").closeModal(),$scope.podcastInfo.url="",$scope.loadingRSSFeed=!1,void $timeout(function(){$scope.loadingPodcasts=!1,$(".tooltipped").tooltip({delay:50})},1e3))}):($scope.podcastInfo.errorMessage="Invalid URL",$scope.podcastInfo.hasError=!0,void($scope.loadingRSSFeed=!1))},$timeout(function(){$(".tooltipped").tooltip({delay:50})},500)}]),zeus.controller("MainCtrl",["$scope","$rootScope","$route","$window","$location",function($scope,$rootScope,$route,$window,$location){$rootScope.$on("$routeChangeError",function(event,curr,prev,rejection){return prev?void $window.history.back():void $location.url("/")}),$rootScope.$on("$routeChangeSuccess",function(){$(".tooltipped").tooltip("remove")})}]),zeus.controller("PlayerPageCtrl",["$scope","$rootScope","$route",function($scope,$rootScope,$route){$scope.episode=$rootScope.podcasts[$route.current.params.podcast].podcasts[$route.current.params.episode],$scope.playback={timePassed:"0:00:00",timeLeft:$scope.episode.podcastLengthParsed,percentPlayedOutput:"0%",currentlyPlaying:!1,lastEpisode:function(){},replay10Seconds:function(){},playPodcast:function(){$scope.playback.currentlyPlaying=!0},pausePodcast:function(){$scope.playback.currentlyPlaying=!1},forward30Seconds:function(){},nextEpisode:function(){}},$('[data-bind="episode.description"]').html($scope.episode.description),$(".tooltipped").tooltip({delay:50})}]),zeus.controller("PodcastPageCtrl",["$scope","$rootScope","$route","$location","$timeout",function($scope,$rootScope,$route,$location,$timeout){$scope.podcast=$rootScope.podcasts[$route.current.params.id],$scope.showUnplayedOnly=!0,$scope.podcast||$location.url("/"),$scope.downloadEpisode=function(id){console.log(id),$scope.podcast.podcasts[id].downloading=!0,$scope.podcast.podcasts[id].downloadPercent=0,Zeus.downloadPodcast($scope.podcast.podcasts[id],function(error,success,percent){$scope.podcast.podcasts[id].downloadPercent=100,$scope.podcast.podcasts[id].downloadPercentOutput=$scope.podcast.podcasts[id].downloadPercent+"%",clearInterval(updateInterval)});var updateInterval=setInterval(function(){$scope.podcast.podcasts[id].downloadPercent++,$scope.podcast.podcasts[id].downloadPercentOutput=$scope.podcast.podcasts[id].downloadPercent+"%"},100)},$scope.deleteEpisode=function(id){Zeus.deleteEpisode($scope.podcast.podcasts[id])},$scope.playPodcast=function(podcast,episode){$scope.podcast.podcasts[episode].isDownloaded&&$location.url("/play/"+podcast+"/"+episode)},$("ul.tabs").tabs()}]),zeus.controller("SettingPageCtrl",["$scope","$rootScope",function($scope,$rootScope){$scope.userSettings={},$scope.saveSettings=function(){$rootScope.settings={lightTheme:!$("input#darkTheme").is(":checked"),animations:$("input#animationsOn").is(":checked"),volume:$("input#volumeRange").val(),analytics:$("input#analyticsOn").is(":checked")},Zeus.saveSettings($rootScope.settings)}}]);